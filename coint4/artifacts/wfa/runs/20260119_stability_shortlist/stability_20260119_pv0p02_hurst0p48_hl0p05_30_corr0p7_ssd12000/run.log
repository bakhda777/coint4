[run_wfa_queue] 2026-01-19T06:49:00Z cmd: /opt/coint4/coint4/run_wfa_fullcpu.sh configs/stability_20260119/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000.yaml artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000
[run_wfa_fullcpu] start: 2026-01-19T06:49:00Z
[run_wfa_fullcpu] os.cpu_count: 8
[run_wfa_fullcpu] worker_pid=1168
2026-01-19 06:49:04,114 - coint2.core.memory_optimization - INFO - ✅ BLAS threading limits set to 1 via threadpoolctl
2026-01-19 06:49:04,115 - coint2.core.memory_optimization - INFO - 🔧 Controlled libraries: openblas, openmp
2026-01-19 06:49:04,115 - coint2.core.memory_optimization - INFO - 🧵 Process threads: 2 → 2
2026-01-19 06:49:04,115 - coint2.core.memory_optimization - INFO - 📝 Set 11 environment variables
2026-01-19 06:49:04,562 - INFO - ✅ Параметры конфигурации валидны
2026-01-19 06:49:04,563 - INFO - 📝 Некоторые параметры были скорректированы:
2026-01-19 06:49:04,563 - INFO - 🧭 WFA: динамический отбор пар на каждом шаге
2026-01-19 06:49:04,563 - INFO -   Шаг 1: тренировка 2023-08-02-2023-09-30, тест 2023-10-01-2023-10-31
2026-01-19 06:49:04,563 - INFO -   Шаг 2: тренировка 2023-09-01-2023-10-30, тест 2023-10-31-2023-11-30
2026-01-19 06:49:04,563 - INFO -   Шаг 3: тренировка 2023-10-01-2023-11-29, тест 2023-11-30-2023-12-30
2026-01-19 06:49:04,563 - INFO -   Шаг 4: тренировка 2023-10-31-2023-12-29, тест 2023-12-30-2024-01-29
2026-01-19 06:49:04,563 - INFO -   Шаг 5: тренировка 2023-11-30-2024-01-28, тест 2024-01-29-2024-02-28
2026-01-19 06:49:04,563 - INFO -   Шаг 6: тренировка 2023-12-30-2024-02-27, тест 2024-02-28-2024-03-29
2026-01-19 06:49:04,563 - INFO -   Шаг 7: тренировка 2024-01-29-2024-03-28, тест 2024-03-29-2024-04-28
2026-01-19 06:49:04,563 - INFO -   Шаг 8: тренировка 2024-02-28-2024-04-27, тест 2024-04-28-2024-05-28
2026-01-19 06:49:04,563 - INFO - 📈 Запланировано 8 walk-forward шагов
2026-01-19 06:49:04,563 - INFO - ⛔ Ограничение WFA шагов: 8 → 5
2026-01-19 06:49:04,563 - WARNING - ⚠️ Маленький буфер между training и testing в шаге 1: 0 дней. Рекомендуется минимум 1 день.
2026-01-19 06:49:04,563 - WARNING - ⚠️ Маленький буфер между training и testing в шаге 2: 0 дней. Рекомендуется минимум 1 день.
2026-01-19 06:49:04,563 - WARNING - ⚠️ Маленький буфер между training и testing в шаге 3: 0 дней. Рекомендуется минимум 1 день.
2026-01-19 06:49:04,564 - WARNING - ⚠️ Маленький буфер между training и testing в шаге 4: 0 дней. Рекомендуется минимум 1 день.
2026-01-19 06:49:04,564 - WARNING - ⚠️ Маленький буфер между training и testing в шаге 5: 0 дней. Рекомендуется минимум 1 день.
2026-01-19 06:49:04,564 - INFO - ✅ Шаги успешно запланированы:
2026-01-19 06:49:04,564 - INFO -    Шаг 1: тренировка 2023-08-02-2023-09-30, тест 2023-10-01-2023-10-31
2026-01-19 06:49:04,564 - INFO -    Шаг 2: тренировка 2023-09-01-2023-10-30, тест 2023-10-31-2023-11-30
2026-01-19 06:49:04,564 - INFO -    Шаг 3: тренировка 2023-10-01-2023-11-29, тест 2023-11-30-2023-12-30
2026-01-19 06:49:04,564 - INFO -    Шаг 4: тренировка 2023-10-31-2023-12-29, тест 2023-12-30-2024-01-29
2026-01-19 06:49:04,564 - INFO -    Шаг 5: тренировка 2023-11-30-2024-01-28, тест 2024-01-29-2024-02-28
2026-01-19 06:49:04,564 - INFO - 🗂️ Consolidating price data for memory-mapped access...
2026-01-19 06:49:04,564 - INFO - 📊 Consolidating data range: 2023-07-28 → 2024-03-04
2026-01-19 06:49:04,564 - coint2.core.memory_optimization - INFO - 🔄 Consolidating price data from data_downloaded to .cache/consolidated_prices.parquet
2026-01-19 06:49:04,564 - INFO - ⇢ loading raw data for consolidation — start
2026-01-19 06:49:06,310 - INFO - ⇠ loading raw data for consolidation — done in 1.75s
2026-01-19 06:49:06,310 - INFO - ⇢ pivoting data to wide format — start
2026-01-19 06:49:11,591 - INFO - ⇠ pivoting data to wide format — done in 5.28s
2026-01-19 06:49:11,633 - coint2.core.memory_optimization - INFO - 📊 Consolidated data: 21121 rows × 346 symbols
2026-01-19 06:49:11,634 - coint2.core.memory_optimization - INFO - 💾 Memory usage: 29.4 MB
2026-01-19 06:49:11,634 - INFO - ⇢ writing consolidated Parquet file — start
2026-01-19 06:49:11,861 - INFO - ⇠ writing consolidated Parquet file — done in 0.23s
2026-01-19 06:49:11,861 - coint2.core.memory_optimization - INFO - ✅ Successfully consolidated data to .cache/consolidated_prices.parquet
2026-01-19 06:49:11,891 - coint2.core.memory_optimization - INFO - 🔄 Initializing memory-mapped price data from .cache/consolidated_prices.parquet
2026-01-19 06:49:11,891 - INFO - ⇢ loading memory-mapped data — start
2026-01-19 06:49:11,891 - coint2.core.memory_optimization - WARNING - ⚠️ memory_map не поддерживается в текущей версии pyarrow, fallback без mmap
2026-01-19 06:49:12,045 - INFO - ⇠ loading memory-mapped data — done in 0.15s
2026-01-19 06:49:12,054 - coint2.core.memory_optimization - INFO - 📊 Loaded 21121 rows × 346 symbols
2026-01-19 06:49:12,054 - coint2.core.memory_optimization - INFO - 💾 Memory usage: 29.4 MB (memory-mapped)
2026-01-19 06:49:12,055 - INFO - ✅ Memory-mapped data initialized successfully
2026-01-19 06:49:12,057 - INFO - ⇢ Walk-forward steps — starting 5 items
2026-01-19 06:49:12,057 - INFO - 📈 Инициализация equity кривой с первой тестовой даты: 2023-10-01 00:00:00
2026-01-19 06:49:12,057 - INFO - 🔍 WF-шаг 1/5: Валидация временных окон...
2026-01-19 06:49:12,058 - INFO - ⇢ WF-шаг 1/5: training 2023-08-02-2023-09-30, testing 2023-10-01-2023-10-31 — start
2026-01-19 06:49:12,058 - INFO - ⇢ loading step data — start
2026-01-19 06:49:12,220 - INFO - ⇠ loading step data — done in 0.16s
2026-01-19 06:49:13,523 - INFO - 📊 WF-шаг 1/5: Границы данных:
2026-01-19 06:49:13,524 - INFO -    Training: 2023-08-02 00:00:00 → 2023-09-30 23:45:00 (5,760 строк × 282 символов)
2026-01-19 06:49:13,524 - INFO -    Testing:  2023-10-01 00:00:00 → 2023-10-31 00:00:00 (2,881 строк × 282 символов)
2026-01-19 06:49:13,524 - INFO -    Временной разрыв: 0 days 00:15:00
2026-01-19 06:49:13,564 - INFO - ⇢ normalizing training data — start
2026-01-19 06:49:13,599 - INFO -   Символы с NaN значениями: 20
2026-01-19 06:49:13,599 - INFO -   Применяем метод нормализации: rolling_zscore
2026-01-19 06:49:13,614 - INFO - Символы с недостаточной историей: 20 из 282
2026-01-19 06:49:14,006 - INFO - Символы с NaN после нормализации: 262
2026-01-19 06:49:14,013 - INFO - Удалено 1 начальных строк с NaN от rolling расчетов
2026-01-19 06:49:14,016 - INFO - Итоговое количество символов после нормализации: 262 из 282
2026-01-19 06:49:14,016 - INFO -   Статистика нормализации:
2026-01-19 06:49:14,016 - INFO -     Исходные символы: 282
2026-01-19 06:49:14,016 - INFO -     Недостаточная история: 20
2026-01-19 06:49:14,016 - INFO -     Постоянная цена: 0
2026-01-19 06:49:14,016 - INFO -     NaN после нормализации: 262
2026-01-19 06:49:14,016 - INFO -     Итоговые символы: 262 (92.9%)
2026-01-19 06:49:14,017 - INFO -   После нормализации: 262 символов (потеряно 20)
2026-01-19 06:49:14,017 - INFO -   Отброшенные символы: ADAEUR, BEAMUSDT, BTCEUR, CYBERUSDT, DOGEEUR, ETHEUR, FETUSDT, JEFFUSDT, KASUSDT, KAVAUSDT, LTCEUR, ORDIUSDT, POLUSDT, PPTUSDT, PYUSDUSDT, SEIUSDT, SOLEUR, USDCEUR, XRPEUR, ZTXUSDT
2026-01-19 06:49:14,017 - INFO - ⇠ normalizing training data — done in 0.45s
2026-01-19 06:49:14,017 - INFO - ⇢ SSD computation — start
2026-01-19 06:49:14,017 - INFO -   Расчет SSD для всех пар (без ограничения)
2026-01-19 06:49:20,090 - INFO -   SSD результат (все пары): 34191 пар
2026-01-19 06:49:20,090 - INFO -   Ограничиваем до top-12000 пар для дальнейшей обработки
2026-01-19 06:49:20,091 - INFO - ⇠ SSD computation — done in 6.07s
2026-01-19 06:49:20,094 - INFO - ⇢ filtering pairs by cointegration and half-life — start
2026-01-19 06:49:20,095 - INFO - [ФИЛЬТР] Параллельная фильтрация: threads (8 workers)
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После проверки данных: 12000 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра корреляции (>0.7): 9006 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра beta: 5906 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра mean crossings: 5906 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра half-life: 5863 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра коинтеграции: 1232 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра Hurst: 128 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра KPSS: 4 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] После фильтра market microstructure: 4 пар
2026-01-19 06:51:45,936 - INFO - [ФИЛЬТР] Статистика фильтрации (оптимизированный порядок):
2026-01-19 06:51:45,936 - INFO -   1. SSD → Коинтеграция: 12000 → 1232 пар
2026-01-19 06:51:45,936 - INFO -   2. Коинтеграция → Beta: 1232 → 5906 пар
2026-01-19 06:51:45,936 - INFO -   3. Beta → Half-life: 5906 → 5863 пар
2026-01-19 06:51:45,936 - INFO -   4. Half-life → Mean crossings: 5863 → 5906 пар
2026-01-19 06:51:45,936 - INFO -   5. Mean crossings → Hurst: 5906 → 128 пар
2026-01-19 06:51:45,936 - INFO -   6. Hurst → KPSS: 128 → 4 пар
2026-01-19 06:51:45,936 - INFO -   7. KPSS → Market microstructure: 4 → 4 пар
2026-01-19 06:51:45,937 - INFO - [ФИЛЬТР] Причины отсева:
2026-01-19 06:51:45,937 - INFO -   • pvalue: 4631 пар (38.6%)
2026-01-19 06:51:45,937 - INFO -   • beta: 3100 пар (25.8%)
2026-01-19 06:51:45,937 - INFO -   • low_correlation: 2994 пар (24.9%)
2026-01-19 06:51:45,937 - INFO -   • hurst: 1104 пар (9.2%)
2026-01-19 06:51:45,937 - INFO -   • kpss: 124 пар (1.0%)
2026-01-19 06:51:45,937 - INFO -   • half_life: 43 пар (0.4%)
2026-01-19 06:51:45,937 - INFO - [ФИЛЬТР] Итого: 12000 → 4 пар (0.0% прошли все фильтры)
2026-01-19 06:51:45,955 - INFO - Причины отсева сохранены в results/filter_reasons_20260119_065145.csv
2026-01-19 06:51:45,959 - INFO -   Pair stability filter: history empty, skip (window=3, min_steps=2)
2026-01-19 06:51:45,960 - INFO -   Фильтрация: 12000 → 4 пар
2026-01-19 06:51:45,960 - INFO - ⇠ filtering pairs by cointegration and half-life — done in 145.87s
2026-01-19 06:51:45,960 - INFO - ⇠ WF-шаг 1/5: training 2023-08-02-2023-09-30, testing 2023-10-01-2023-10-31 — done in 153.90s
2026-01-19 06:51:45,960 - INFO -   Топ-3 пары по волатильности спреда:
2026-01-19 06:51:45,960 - INFO -     1. CELOUSDT-ZRXUSDT: beta=1.5906, std=0.0123
2026-01-19 06:51:45,960 - INFO -     2. FLOWUSDT-MASKUSDT: beta=0.1359, std=0.0081
2026-01-19 06:51:45,960 - INFO -     3. ONEUSDT-XRPUSDC: beta=0.0130, std=0.0002
2026-01-19 06:51:45,960 - INFO -   Всего пар для торговли: 4 (ограничение 15 применяется к одновременно открытым позициям)
2026-01-19 06:51:45,960 - INFO -   💰 Проверка расчета капитала: equity=$10,000.00, кандидатных_пар=4, max_позиций=15
2026-01-19 06:51:45,960 - INFO -   🎯 Target concurrency: 4 (ожидаемое одновременное число позиций)
2026-01-19 06:51:45,960 - INFO -   📊 Детали расчета капитала:
2026-01-19 06:51:45,960 - INFO -      • Базовый капитал на пару: $2,500.00 (equity / target_concurrency)
2026-01-19 06:51:45,960 - INFO -      • Риск-капитал: $150.00 (1.5% от equity)
2026-01-19 06:51:45,960 - INFO -      • Макс. размер позиции: $200.00 (2.0% от equity)
2026-01-19 06:51:45,960 - INFO -      • Итоговый капитал на пару: $150.00
2026-01-19 06:51:45,961 - INFO - ⇢ WF-шаг 1/5 backtests — starting 4 items
2026-01-19 06:51:45,961 - INFO - 🚀 WF-шаг 1/5: Начинаем бэктесты для 4 пар...
2026-01-19 06:51:45,961 - INFO - 🚀 WF-шаг 1/5: Запускаем параллельную обработку 4 пар на 8 ядрах...
2026-01-19 06:51:45,961 - INFO - 🚀 WF-шаг 1/5: Режим параллельности: процессы
⚙️  Загрузка данных за период: 2023-07-28 -> 2024-03-04
📂 Найдено 43 parquet файлов для обработки.
📊 Схема данных: Schema({'timestamp': Int64, 'open': Float64, 'high': Float64, 'low': Float64, 'close': Float64, 'volume': Float64, 'turnover': String, 'ts_ms': Int64, 'symbol': String})
✅ Загружено 6226682 записей с помощью Polars.
📊 Типы данных в pandas: timestamp       datetime64[us]
symbol                  object
close                  float64
timestamp_ms             int64
dtype: object
⚙️  Загрузка данных за период: 2023-08-02 -> 2023-10-31
📂 Найдено 43 parquet файлов для обработки.
📊 Схема данных: Schema({'timestamp': Int64, 'open': Float64, 'high': Float64, 'low': Float64, 'close': Float64, 'volume': Float64, 'turnover': String, 'ts_ms': Int64, 'symbol': String})
✅ Загружено 2351056 записей с помощью Polars.
📊 Типы данных в pandas: timestamp       datetime64[us]
symbol                  object
close                  float64
timestamp_ms             int64
dtype: object
2026-01-19 06:51:46,011 - coint2.engine.numba_engine - INFO - Запуск Numba-оптимизированного бэктеста для CELOUSDT-ZRXUSDT
2026-01-19 06:51:46,028 - coint2.engine.numba_engine - INFO - Запуск Numba-оптимизированного бэктеста для FLOWUSDT-MASKUSDT
2026-01-19 06:51:46,048 - coint2.engine.numba_engine - INFO - Запуск Numba-оптимизированного бэктеста для ONEUSDT-XRPUSDC
2026-01-19 06:51:46,069 - coint2.engine.numba_engine - INFO - Запуск Numba-оптимизированного бэктеста для ONEUSDT-XRPUSDT
2026-01-19 06:51:46,161 - INFO -   ⏱️ Параллельная обработка завершена за 0.2с (20.0 пар/с)
2026-01-19 06:51:46,165 - coint2.pipeline.walk_forward_orchestrator - INFO - 🎯 СИМУЛЯЦИЯ ПОРТФЕЛЯ: 4 пар, лимит 15 позиций
2026-01-19 06:51:46,451 - coint2.pipeline.walk_forward_orchestrator - INFO -    📈 Макс. одновременных сигналов: 4
2026-01-19 06:51:46,452 - coint2.pipeline.walk_forward_orchestrator - INFO -    📊 Средн. сигналов за период: 0.1
2026-01-19 06:51:46,452 - coint2.pipeline.walk_forward_orchestrator - INFO -    🎯 Финальных активных позиций: 0
2026-01-19 06:51:46,453 - coint2.pipeline.walk_forward_orchestrator - INFO -    ⚡ Утилизация лимита позиций: 0.4%
2026-01-19 06:51:46,454 - INFO - ⇠ WF-шаг 1/5 backtests — completed 4 items in 0.49s (8.1 items/s)
2026-01-19 06:51:46,454 - INFO -   ✅ Обработка завершена: 4 успешно, 0 с ошибками
2026-01-19 06:51:46,454 - INFO -   📊 Успешность: 100.0%, прибыльность: 75.0%, сделок/пара: 19.8
2026-01-19 06:51:46,454 - INFO -   ✅ Завершены бэктесты для 4 пар
2026-01-19 06:51:46,454 - INFO -   📊 Всего обработано пар в этом шаге: 4
2026-01-19 06:51:46,454 - INFO -   📈 Результаты шага: 3/4 прибыльных пар, 79 сделок
2026-01-19 06:51:46,454 - INFO -   💰 P&L шага: $+16.68
2026-01-19 06:51:46,454 - INFO -   ⇢ Обновление капитала и дневного P&L...
2026-01-19 06:51:47,589 - INFO -   💼 Шаг P&L: $+16.68, Накопленный капитал: $10,016.68
2026-01-19 06:51:47,590 - INFO - ------------------------------------------------------------
2026-01-19 06:51:47,590 - INFO -   Walk-forward steps: 1 / 5 (20.0%) | 0.0 items/s | ETA: 622.1s
2026-01-19 06:51:47,590 - INFO - 🔍 WF-шаг 2/5: Валидация временных окон...
2026-01-19 06:51:47,590 - INFO - ⇢ WF-шаг 2/5: training 2023-09-01-2023-10-30, testing 2023-10-31-2023-11-30 — start
2026-01-19 06:51:47,590 - INFO - ⇢ loading step data — start
2026-01-19 06:51:47,773 - INFO - ⇠ loading step data — done in 0.18s
2026-01-19 06:51:48,976 - INFO - 📊 WF-шаг 2/5: Границы данных:
2026-01-19 06:51:48,976 - INFO -    Training: 2023-09-01 00:00:00 → 2023-10-30 23:45:00 (5,760 строк × 292 символов)
2026-01-19 06:51:48,976 - INFO -    Testing:  2023-10-31 00:00:00 → 2023-11-30 00:00:00 (2,881 строк × 292 символов)
2026-01-19 06:51:48,976 - INFO -    Временной разрыв: 0 days 00:15:00
2026-01-19 06:51:49,013 - INFO - ⇢ normalizing training data — start
2026-01-19 06:51:49,044 - INFO -   Символы с NaN значениями: 26
2026-01-19 06:51:49,044 - INFO -   Применяем метод нормализации: rolling_zscore
2026-01-19 06:51:49,058 - INFO - Символы с недостаточной историей: 17 из 292
2026-01-19 06:51:49,441 - INFO - Символы с NaN после нормализации: 275
2026-01-19 06:51:49,447 - INFO - Удалено 617 начальных строк с NaN от rolling расчетов
2026-01-19 06:51:49,449 - INFO - Итоговое количество символов после нормализации: 275 из 292
2026-01-19 06:51:49,449 - INFO -   Статистика нормализации:
2026-01-19 06:51:49,449 - INFO -     Исходные символы: 292
2026-01-19 06:51:49,449 - INFO -     Недостаточная история: 17
2026-01-19 06:51:49,449 - INFO -     Постоянная цена: 0
2026-01-19 06:51:49,449 - INFO -     NaN после нормализации: 275
2026-01-19 06:51:49,449 - INFO -     Итоговые символы: 275 (94.2%)
2026-01-19 06:51:49,449 - INFO -   После нормализации: 275 символов (потеряно 17)
2026-01-19 06:51:49,449 - INFO -   Отброшенные символы: BEAMUSDT, FETUSDT, FLIPUSDT, JEFFUSDT, MEMEUSDT, POLUSDT, PPTUSDT, PYTHUSDT, PYUSDUSDT, ROOTUSDT, RPKUSDT, SHRAPUSDT, TIAUSDT, TOKENUSDT, TUSDUSDT, VRTXUSDT, ZTXUSDT
2026-01-19 06:51:49,450 - INFO - ⇠ normalizing training data — done in 0.44s
2026-01-19 06:51:49,450 - INFO - ⇢ SSD computation — start
2026-01-19 06:51:49,450 - INFO -   Расчет SSD для всех пар (без ограничения)
2026-01-19 06:51:51,640 - INFO -   SSD результат (все пары): 37675 пар
2026-01-19 06:51:51,641 - INFO -   Ограничиваем до top-12000 пар для дальнейшей обработки
2026-01-19 06:51:51,642 - INFO - ⇠ SSD computation — done in 2.19s
2026-01-19 06:51:51,645 - INFO - ⇢ filtering pairs by cointegration and half-life — start
2026-01-19 06:51:51,646 - INFO - [ФИЛЬТР] Параллельная фильтрация: threads (8 workers)
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После проверки данных: 12000 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра корреляции (>0.7): 4923 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра beta: 3297 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра mean crossings: 3297 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра half-life: 3257 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра коинтеграции: 773 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра Hurst: 147 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра KPSS: 2 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] После фильтра market microstructure: 2 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] Статистика фильтрации (оптимизированный порядок):
2026-01-19 06:53:28,000 - INFO -   1. SSD → Коинтеграция: 12000 → 773 пар
2026-01-19 06:53:28,000 - INFO -   2. Коинтеграция → Beta: 773 → 3297 пар
2026-01-19 06:53:28,000 - INFO -   3. Beta → Half-life: 3297 → 3257 пар
2026-01-19 06:53:28,000 - INFO -   4. Half-life → Mean crossings: 3257 → 3297 пар
2026-01-19 06:53:28,000 - INFO -   5. Mean crossings → Hurst: 3297 → 147 пар
2026-01-19 06:53:28,000 - INFO -   6. Hurst → KPSS: 147 → 2 пар
2026-01-19 06:53:28,000 - INFO -   7. KPSS → Market microstructure: 2 → 2 пар
2026-01-19 06:53:28,000 - INFO - [ФИЛЬТР] Причины отсева:
2026-01-19 06:53:28,000 - INFO -   • low_correlation: 7077 пар (59.0%)
2026-01-19 06:53:28,001 - INFO -   • pvalue: 2484 пар (20.7%)
2026-01-19 06:53:28,001 - INFO -   • beta: 1626 пар (13.6%)
2026-01-19 06:53:28,001 - INFO -   • hurst: 626 пар (5.2%)
2026-01-19 06:53:28,001 - INFO -   • kpss: 145 пар (1.2%)
2026-01-19 06:53:28,001 - INFO -   • half_life: 40 пар (0.3%)
2026-01-19 06:53:28,001 - INFO - [ФИЛЬТР] Итого: 12000 → 2 пар (0.0% прошли все фильтры)
2026-01-19 06:53:28,018 - INFO - Причины отсева сохранены в results/filter_reasons_20260119_065328.csv
2026-01-19 06:53:28,022 - INFO -   Pair stability filter: 2 → 0 (window=3, min_steps=2)
2026-01-19 06:53:28,022 - INFO -   Фильтрация: 12000 → 0 пар
2026-01-19 06:53:28,022 - INFO - ⇠ filtering pairs by cointegration and half-life — done in 96.38s
2026-01-19 06:53:28,022 - INFO - ⇠ WF-шаг 2/5: training 2023-09-01-2023-10-30, testing 2023-10-31-2023-11-30 — done in 100.43s
2026-01-19 06:53:28,023 - INFO -   Всего пар для торговли: 0 (ограничение 15 применяется к одновременно открытым позициям)
2026-01-19 06:53:28,023 - INFO -   💰 Проверка расчета капитала: equity=$10,016.68, кандидатных_пар=0, max_позиций=15
2026-01-19 06:53:28,023 - INFO -   🎯 Target concurrency: 0 (ожидаемое одновременное число позиций)
2026-01-19 06:53:28,023 - INFO -   💼 Шаг P&L: $+0.00, Накопленный капитал: $10,016.68
2026-01-19 06:53:28,024 - INFO - ------------------------------------------------------------
2026-01-19 06:53:28,024 - INFO -   Walk-forward steps: 2 / 5 (40.0%) | 0.0 items/s | ETA: 384.0s
2026-01-19 06:53:28,024 - INFO - 🔍 WF-шаг 3/5: Валидация временных окон...
2026-01-19 06:53:28,024 - INFO - ⇢ WF-шаг 3/5: training 2023-10-01-2023-11-29, testing 2023-11-30-2023-12-30 — start
2026-01-19 06:53:28,024 - INFO - ⇢ loading step data — start
2026-01-19 06:53:28,186 - INFO - ⇠ loading step data — done in 0.16s
2026-01-19 06:53:29,463 - INFO - 📊 WF-шаг 3/5: Границы данных:
2026-01-19 06:53:29,464 - INFO -    Training: 2023-10-01 00:00:00 → 2023-11-29 23:45:00 (5,760 строк × 309 символов)
2026-01-19 06:53:29,464 - INFO -    Testing:  2023-11-30 00:00:00 → 2023-12-30 00:00:00 (2,881 строк × 309 символов)
2026-01-19 06:53:29,464 - INFO -    Временной разрыв: 0 days 00:15:00
2026-01-19 06:53:29,500 - INFO - ⇢ normalizing training data — start
2026-01-19 06:53:29,534 - INFO -   Символы с NaN значениями: 33
2026-01-19 06:53:29,534 - INFO -   Применяем метод нормализации: rolling_zscore
2026-01-19 06:53:29,547 - INFO - Символы с недостаточной историей: 32 из 309
2026-01-19 06:53:29,933 - INFO - Символы с NaN после нормализации: 277
2026-01-19 06:53:29,939 - INFO - Удалено 233 начальных строк с NaN от rolling расчетов
2026-01-19 06:53:29,941 - INFO - Итоговое количество символов после нормализации: 277 из 309
2026-01-19 06:53:29,941 - INFO -   Статистика нормализации:
2026-01-19 06:53:29,941 - INFO -     Исходные символы: 309
2026-01-19 06:53:29,941 - INFO -     Недостаточная история: 32
2026-01-19 06:53:29,941 - INFO -     Постоянная цена: 0
2026-01-19 06:53:29,941 - INFO -     NaN после нормализации: 277
2026-01-19 06:53:29,941 - INFO -     Итоговые символы: 277 (89.6%)
2026-01-19 06:53:29,941 - INFO -   После нормализации: 277 символов (потеряно 32)
2026-01-19 06:53:29,941 - INFO -   Отброшено много символов: 32 из 309
2026-01-19 06:53:29,942 - INFO - ⇠ normalizing training data — done in 0.44s
2026-01-19 06:53:29,942 - INFO - ⇢ SSD computation — start
2026-01-19 06:53:29,942 - INFO -   Расчет SSD для всех пар (без ограничения)
2026-01-19 06:53:32,330 - INFO -   SSD результат (все пары): 38226 пар
2026-01-19 06:53:32,330 - INFO -   Ограничиваем до top-12000 пар для дальнейшей обработки
2026-01-19 06:53:32,331 - INFO - ⇠ SSD computation — done in 2.39s
2026-01-19 06:53:32,335 - INFO - ⇢ filtering pairs by cointegration and half-life — start
2026-01-19 06:53:32,335 - INFO - [ФИЛЬТР] Параллельная фильтрация: threads (8 workers)
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После проверки данных: 12000 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра корреляции (>0.7): 10477 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра beta: 7279 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра mean crossings: 7277 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра half-life: 7236 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра коинтеграции: 1058 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра Hurst: 47 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра KPSS: 2 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] После фильтра market microstructure: 2 пар
2026-01-19 06:56:06,191 - INFO - [ФИЛЬТР] Статистика фильтрации (оптимизированный порядок):
2026-01-19 06:56:06,191 - INFO -   1. SSD → Коинтеграция: 12000 → 1058 пар
2026-01-19 06:56:06,191 - INFO -   2. Коинтеграция → Beta: 1058 → 7279 пар
2026-01-19 06:56:06,191 - INFO -   3. Beta → Half-life: 7279 → 7236 пар
2026-01-19 06:56:06,191 - INFO -   4. Half-life → Mean crossings: 7236 → 7277 пар
2026-01-19 06:56:06,191 - INFO -   5. Mean crossings → Hurst: 7277 → 47 пар
2026-01-19 06:56:06,192 - INFO -   6. Hurst → KPSS: 47 → 2 пар
2026-01-19 06:56:06,192 - INFO -   7. KPSS → Market microstructure: 2 → 2 пар
2026-01-19 06:56:06,192 - INFO - [ФИЛЬТР] Причины отсева:
2026-01-19 06:56:06,192 - INFO -   • pvalue: 6178 пар (51.5%)
2026-01-19 06:56:06,192 - INFO -   • beta: 3198 пар (26.7%)
2026-01-19 06:56:06,192 - INFO -   • low_correlation: 1523 пар (12.7%)
2026-01-19 06:56:06,192 - INFO -   • hurst: 1011 пар (8.4%)
2026-01-19 06:56:06,192 - INFO -   • kpss: 45 пар (0.4%)
2026-01-19 06:56:06,192 - INFO -   • half_life: 41 пар (0.3%)
2026-01-19 06:56:06,192 - INFO -   • crossings: 2 пар (0.0%)
2026-01-19 06:56:06,192 - INFO - [ФИЛЬТР] Итого: 12000 → 2 пар (0.0% прошли все фильтры)
2026-01-19 06:56:06,213 - INFO - Причины отсева сохранены в results/filter_reasons_20260119_065606.csv
2026-01-19 06:56:06,219 - INFO -   Pair stability filter: 2 → 0 (window=3, min_steps=2)
2026-01-19 06:56:06,219 - INFO -   Фильтрация: 12000 → 0 пар
2026-01-19 06:56:06,219 - INFO - ⇠ filtering pairs by cointegration and half-life — done in 153.88s
2026-01-19 06:56:06,219 - INFO - ⇠ WF-шаг 3/5: training 2023-10-01-2023-11-29, testing 2023-11-30-2023-12-30 — done in 158.19s
2026-01-19 06:56:06,219 - INFO -   Всего пар для торговли: 0 (ограничение 15 применяется к одновременно открытым позициям)
2026-01-19 06:56:06,219 - INFO -   💰 Проверка расчета капитала: equity=$10,016.68, кандидатных_пар=0, max_позиций=15
2026-01-19 06:56:06,219 - INFO -   🎯 Target concurrency: 0 (ожидаемое одновременное число позиций)
2026-01-19 06:56:06,220 - INFO -   💼 Шаг P&L: $+0.00, Накопленный капитал: $10,016.68
2026-01-19 06:56:06,220 - INFO - ------------------------------------------------------------
2026-01-19 06:56:06,220 - INFO -   Walk-forward steps: 3 / 5 (60.0%) | 0.0 items/s | ETA: 276.1s
2026-01-19 06:56:06,220 - INFO - 🔍 WF-шаг 4/5: Валидация временных окон...
2026-01-19 06:56:06,221 - INFO - ⇢ WF-шаг 4/5: training 2023-10-31-2023-12-29, testing 2023-12-30-2024-01-29 — start
2026-01-19 06:56:06,221 - INFO - ⇢ loading step data — start
2026-01-19 06:56:06,402 - INFO - ⇠ loading step data — done in 0.18s
2026-01-19 06:56:07,765 - INFO - 📊 WF-шаг 4/5: Границы данных:
2026-01-19 06:56:07,765 - INFO -    Training: 2023-10-31 00:00:00 → 2023-12-29 23:45:00 (5,760 строк × 327 символов)
2026-01-19 06:56:07,765 - INFO -    Testing:  2023-12-30 00:00:00 → 2024-01-29 00:00:00 (2,881 строк × 327 символов)
2026-01-19 06:56:07,765 - INFO -    Временной разрыв: 0 days 00:15:00
2026-01-19 06:56:07,804 - INFO - ⇢ normalizing training data — start
2026-01-19 06:56:07,839 - INFO -   Символы с NaN значениями: 45
2026-01-19 06:56:07,840 - INFO -   Применяем метод нормализации: rolling_zscore
2026-01-19 06:56:07,855 - INFO - Символы с недостаточной историей: 40 из 327
2026-01-19 06:56:08,252 - INFO - Символы с NaN после нормализации: 287
2026-01-19 06:56:08,257 - INFO - Удалено 809 начальных строк с NaN от rolling расчетов
2026-01-19 06:56:08,259 - INFO - Итоговое количество символов после нормализации: 287 из 327
2026-01-19 06:56:08,259 - INFO -   Статистика нормализации:
2026-01-19 06:56:08,259 - INFO -     Исходные символы: 327
2026-01-19 06:56:08,260 - INFO -     Недостаточная история: 40
2026-01-19 06:56:08,260 - INFO -     Постоянная цена: 0
2026-01-19 06:56:08,260 - INFO -     NaN после нормализации: 287
2026-01-19 06:56:08,260 - INFO -     Итоговые символы: 287 (87.8%)
2026-01-19 06:56:08,260 - INFO -   После нормализации: 287 символов (потеряно 40)
2026-01-19 06:56:08,260 - INFO -   Отброшено много символов: 40 из 327
2026-01-19 06:56:08,260 - INFO - ⇠ normalizing training data — done in 0.46s
2026-01-19 06:56:08,260 - INFO - ⇢ SSD computation — start
2026-01-19 06:56:08,260 - INFO -   Расчет SSD для всех пар (без ограничения)
2026-01-19 06:56:10,552 - INFO -   SSD результат (все пары): 41041 пар
2026-01-19 06:56:10,552 - INFO -   Ограничиваем до top-12000 пар для дальнейшей обработки
2026-01-19 06:56:10,554 - INFO - ⇠ SSD computation — done in 2.29s
2026-01-19 06:56:10,558 - INFO - ⇢ filtering pairs by cointegration and half-life — start
2026-01-19 06:56:10,558 - INFO - [ФИЛЬТР] Параллельная фильтрация: threads (8 workers)
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После проверки данных: 12000 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра корреляции (>0.7): 5952 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра beta: 4051 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра mean crossings: 4051 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра half-life: 4010 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра коинтеграции: 711 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра Hurst: 50 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра KPSS: 0 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] После фильтра market microstructure: 0 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] Статистика фильтрации (оптимизированный порядок):
2026-01-19 06:57:55,417 - INFO -   1. SSD → Коинтеграция: 12000 → 711 пар
2026-01-19 06:57:55,417 - INFO -   2. Коинтеграция → Beta: 711 → 4051 пар
2026-01-19 06:57:55,417 - INFO -   3. Beta → Half-life: 4051 → 4010 пар
2026-01-19 06:57:55,417 - INFO -   4. Half-life → Mean crossings: 4010 → 4051 пар
2026-01-19 06:57:55,417 - INFO -   5. Mean crossings → Hurst: 4051 → 50 пар
2026-01-19 06:57:55,417 - INFO -   6. Hurst → KPSS: 50 → 0 пар
2026-01-19 06:57:55,417 - INFO -   7. KPSS → Market microstructure: 0 → 0 пар
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] Причины отсева:
2026-01-19 06:57:55,417 - INFO -   • low_correlation: 6048 пар (50.4%)
2026-01-19 06:57:55,417 - INFO -   • pvalue: 3299 пар (27.5%)
2026-01-19 06:57:55,417 - INFO -   • beta: 1901 пар (15.8%)
2026-01-19 06:57:55,417 - INFO -   • hurst: 661 пар (5.5%)
2026-01-19 06:57:55,417 - INFO -   • kpss: 50 пар (0.4%)
2026-01-19 06:57:55,417 - INFO -   • half_life: 41 пар (0.3%)
2026-01-19 06:57:55,417 - INFO - [ФИЛЬТР] Итого: 12000 → 0 пар (0.0% прошли все фильтры)
2026-01-19 06:57:55,434 - INFO - Причины отсева сохранены в results/filter_reasons_20260119_065755.csv
2026-01-19 06:57:55,438 - INFO -   Pair stability filter: 0 → 0 (window=3, min_steps=2)
2026-01-19 06:57:55,438 - INFO -   Фильтрация: 12000 → 0 пар
2026-01-19 06:57:55,438 - INFO - ⇠ filtering pairs by cointegration and half-life — done in 104.88s
2026-01-19 06:57:55,438 - INFO - ⇠ WF-шаг 4/5: training 2023-10-31-2023-12-29, testing 2023-12-30-2024-01-29 — done in 109.22s
2026-01-19 06:57:55,439 - INFO -   Всего пар для торговли: 0 (ограничение 15 применяется к одновременно открытым позициям)
2026-01-19 06:57:55,439 - INFO -   💰 Проверка расчета капитала: equity=$10,016.68, кандидатных_пар=0, max_позиций=15
2026-01-19 06:57:55,439 - INFO -   🎯 Target concurrency: 0 (ожидаемое одновременное число позиций)
2026-01-19 06:57:55,439 - INFO -   💼 Шаг P&L: $+0.00, Накопленный капитал: $10,016.68
2026-01-19 06:57:55,439 - INFO - ------------------------------------------------------------
2026-01-19 06:57:55,439 - INFO -   Walk-forward steps: 4 / 5 (80.0%) | 0.0 items/s | ETA: 130.8s
2026-01-19 06:57:55,439 - INFO - 🔍 WF-шаг 5/5: Валидация временных окон...
2026-01-19 06:57:55,440 - INFO - ⇢ WF-шаг 5/5: training 2023-11-30-2024-01-28, testing 2024-01-29-2024-02-28 — start
2026-01-19 06:57:55,440 - INFO - ⇢ loading step data — start
2026-01-19 06:57:55,634 - INFO - ⇠ loading step data — done in 0.19s
2026-01-19 06:57:57,059 - INFO - 📊 WF-шаг 5/5: Границы данных:
2026-01-19 06:57:57,059 - INFO -    Training: 2023-11-30 00:00:00 → 2024-01-28 23:45:00 (5,760 строк × 344 символов)
2026-01-19 06:57:57,059 - INFO -    Testing:  2024-01-29 00:00:00 → 2024-02-28 00:00:00 (2,881 строк × 344 символов)
2026-01-19 06:57:57,059 - INFO -    Временной разрыв: 0 days 00:15:00
2026-01-19 06:57:57,101 - INFO - ⇢ normalizing training data — start
2026-01-19 06:57:57,138 - INFO -   Символы с NaN значениями: 52
2026-01-19 06:57:57,138 - INFO -   Применяем метод нормализации: rolling_zscore
2026-01-19 06:57:57,154 - INFO - Символы с недостаточной историей: 44 из 344
2026-01-19 06:57:57,587 - INFO - Символы с NaN после нормализации: 300
2026-01-19 06:57:57,601 - INFO - Удалено 809 начальных строк с NaN от rolling расчетов
2026-01-19 06:57:57,603 - INFO - Итоговое количество символов после нормализации: 300 из 344
2026-01-19 06:57:57,604 - INFO -   Статистика нормализации:
2026-01-19 06:57:57,604 - INFO -     Исходные символы: 344
2026-01-19 06:57:57,604 - INFO -     Недостаточная история: 44
2026-01-19 06:57:57,604 - INFO -     Постоянная цена: 0
2026-01-19 06:57:57,604 - INFO -     NaN после нормализации: 300
2026-01-19 06:57:57,604 - INFO -     Итоговые символы: 300 (87.2%)
2026-01-19 06:57:57,604 - INFO -   После нормализации: 300 символов (потеряно 44)
2026-01-19 06:57:57,604 - INFO -   Отброшено много символов: 44 из 344
2026-01-19 06:57:57,604 - INFO - ⇠ normalizing training data — done in 0.50s
2026-01-19 06:57:57,605 - INFO - ⇢ SSD computation — start
2026-01-19 06:57:57,605 - INFO -   Расчет SSD для всех пар (без ограничения)
2026-01-19 06:58:00,054 - INFO -   SSD результат (все пары): 44850 пар
2026-01-19 06:58:00,054 - INFO -   Ограничиваем до top-12000 пар для дальнейшей обработки
2026-01-19 06:58:00,055 - INFO - ⇠ SSD computation — done in 2.45s
2026-01-19 06:58:00,059 - INFO - ⇢ filtering pairs by cointegration and half-life — start
2026-01-19 06:58:00,060 - INFO - [ФИЛЬТР] Параллельная фильтрация: threads (8 workers)
2026-01-19 06:59:20,999 - INFO - [ФИЛЬТР] После проверки данных: 12000 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра корреляции (>0.7): 2908 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра beta: 2228 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра mean crossings: 2228 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра half-life: 2185 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра коинтеграции: 694 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра Hurst: 52 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра KPSS: 4 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] После фильтра market microstructure: 4 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] Статистика фильтрации (оптимизированный порядок):
2026-01-19 06:59:21,000 - INFO -   1. SSD → Коинтеграция: 12000 → 694 пар
2026-01-19 06:59:21,000 - INFO -   2. Коинтеграция → Beta: 694 → 2228 пар
2026-01-19 06:59:21,000 - INFO -   3. Beta → Half-life: 2228 → 2185 пар
2026-01-19 06:59:21,000 - INFO -   4. Half-life → Mean crossings: 2185 → 2228 пар
2026-01-19 06:59:21,000 - INFO -   5. Mean crossings → Hurst: 2228 → 52 пар
2026-01-19 06:59:21,000 - INFO -   6. Hurst → KPSS: 52 → 4 пар
2026-01-19 06:59:21,000 - INFO -   7. KPSS → Market microstructure: 4 → 4 пар
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] Причины отсева:
2026-01-19 06:59:21,000 - INFO -   • low_correlation: 9092 пар (75.8%)
2026-01-19 06:59:21,000 - INFO -   • pvalue: 1491 пар (12.4%)
2026-01-19 06:59:21,000 - INFO -   • beta: 680 пар (5.7%)
2026-01-19 06:59:21,000 - INFO -   • hurst: 642 пар (5.3%)
2026-01-19 06:59:21,000 - INFO -   • kpss: 48 пар (0.4%)
2026-01-19 06:59:21,000 - INFO -   • half_life: 43 пар (0.4%)
2026-01-19 06:59:21,000 - INFO - [ФИЛЬТР] Итого: 12000 → 4 пар (0.0% прошли все фильтры)
2026-01-19 06:59:21,018 - INFO - Причины отсева сохранены в results/filter_reasons_20260119_065921.csv
2026-01-19 06:59:21,022 - INFO -   Pair stability filter: 4 → 0 (window=3, min_steps=2)
2026-01-19 06:59:21,023 - INFO -   Фильтрация: 12000 → 0 пар
2026-01-19 06:59:21,023 - INFO - ⇠ filtering pairs by cointegration and half-life — done in 80.96s
2026-01-19 06:59:21,023 - INFO - ⇠ WF-шаг 5/5: training 2023-11-30-2024-01-28, testing 2024-01-29-2024-02-28 — done in 85.58s
2026-01-19 06:59:21,023 - INFO -   Всего пар для торговли: 0 (ограничение 15 применяется к одновременно открытым позициям)
2026-01-19 06:59:21,023 - INFO -   💰 Проверка расчета капитала: equity=$10,016.68, кандидатных_пар=0, max_позиций=15
2026-01-19 06:59:21,023 - INFO -   🎯 Target concurrency: 0 (ожидаемое одновременное число позиций)
2026-01-19 06:59:21,023 - INFO -   💼 Шаг P&L: $+0.00, Накопленный капитал: $10,016.68
2026-01-19 06:59:21,024 - INFO - ------------------------------------------------------------
2026-01-19 06:59:21,024 - INFO -   Walk-forward steps: 5 / 5 (100.0%) | 0.0 items/s | ETA: 0.0s
2026-01-19 06:59:21,024 - INFO - ⇠ Walk-forward steps — completed 5 items in 608.97s (0.0 items/s)
2026-01-19 06:59:21,024 - INFO - ================================================================================
2026-01-19 06:59:21,024 - INFO - 🏁 Walk-forward анализ завершен!
2026-01-19 06:59:21,024 - INFO - ⏱️ Обработано 5 шагов за 455.1 секунд
2026-01-19 06:59:21,024 - INFO - 📊 Всего обработано пар за весь анализ: 4
2026-01-19 06:59:21,024 - INFO - 💰 Финальный капитал: $10,016.68 (было $10,000.00)
2026-01-19 06:59:21,024 - INFO - 📈 Общая доходность: +0.17% ($+16.68)
2026-01-19 06:59:21,024 - INFO - 📊 Всего сделок: 0
2026-01-19 06:59:21,024 - INFO - ================================================================================
2026-01-19 06:59:21,024 - INFO - ✓ Завершены все 5 WF-шагов
2026-01-19 06:59:21,024 - INFO - ⇢ Обработка финальных результатов и расчет метрик...
2026-01-19 06:59:21,024 - INFO - ⇢ processing final results — start
2026-01-19 06:59:21,024 - INFO -   ⇢ Агрегация данных P&L за 2881 торговых дней
2026-01-19 06:59:21,033 - INFO -   ⇢ Расчет базовых метрик производительности...
2026-01-19 06:59:21,033 - INFO -     📊 Данные для анализа: 2881 записей P&L, 2881 точек equity
2026-01-19 06:59:21,035 - INFO -   ⇢ Расчет расширенных метрик (волатильность, Calmar ratio, и др.)...
2026-01-19 06:59:21,035 - INFO -   ✅ Расширенные метрики рассчитаны: 6 показателей
2026-01-19 06:59:21,035 - INFO -   ⇢ Анализ статистики по 4 парам...
2026-01-19 06:59:21,037 - INFO - ✅ Рассчитаны метрики производительности (19 показателей)
2026-01-19 06:59:21,037 - INFO -   💰 Общий P&L: $+16.68
2026-01-19 06:59:21,037 - INFO -   📊 Sharpe Ratio: 4.214
2026-01-19 06:59:21,037 - INFO -   📉 Максимальная просадка: -753.57%
2026-01-19 06:59:21,037 - INFO -   🔄 Всего сделок: 79
2026-01-19 06:59:21,037 - INFO -   📈 Торгуемых пар: 4
2026-01-19 06:59:21,037 - INFO -   💸 Общие издержки: $3.72
2026-01-19 06:59:21,037 - coint2.metrics - INFO - Metric: total_pnl
2026-01-19 06:59:21,038 - coint2.metrics - INFO - Metric: sharpe_ratio_abs
2026-01-19 06:59:21,038 - coint2.metrics - INFO - Metric: max_drawdown_pct
2026-01-19 06:59:21,038 - coint2.metrics - INFO - Metric: total_trades
2026-01-19 06:59:21,038 - coint2.metrics - INFO - Metric: total_pairs_traded
2026-01-19 06:59:21,038 - coint2.metrics - INFO - Metric: total_costs
2026-01-19 06:59:21,038 - INFO - ⇠ processing final results — done in 0.01s
2026-01-19 06:59:21,038 - INFO - ⇢ Создание отчетов и сохранение результатов...
2026-01-19 06:59:21,038 - INFO - ⇢ generating reports — start
2026-01-19 06:59:21,039 - INFO -   ⇢ Создание отчета о производительности...
2026-01-19 06:59:25,090 - INFO -   ✓ Отчет о производительности создан
2026-01-19 06:59:25,090 - INFO -   ⇢ Сохранение данных в CSV файлы...
2026-01-19 06:59:25,091 - INFO - 📋 Метрики сохранены: artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000/strategy_metrics.csv
2026-01-19 06:59:25,092 - INFO - 📈 Дневные P&L сохранены: artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000/daily_pnl.csv (31 записей)
2026-01-19 06:59:25,103 - INFO - 💹 Кривая капитала сохранена: artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000/equity_curve.csv (2881 точек)
2026-01-19 06:59:25,105 - INFO - 📋 Статистика сделок сохранена: artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000/trade_statistics.csv (4 записей)
2026-01-19 06:59:25,105 - INFO - 🎉 Walk-Forward анализ полностью завершен!
2026-01-19 06:59:25,105 - INFO - 📊 Все отчеты и данные сохранены в: artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000
2026-01-19 06:59:25,106 - INFO - 💼 Итоговый капитал: $10,016.68
2026-01-19 06:59:25,106 - INFO - ⏱️  Общее время выполнения: 459.1 секунд
2026-01-19 06:59:25,106 - INFO - ⇠ generating reports — done in 4.07s
2026-01-19 06:59:25,106 - coint2.core.memory_optimization - INFO - 🧹 Cleaning up global price data
2026-01-19 06:59:25,109 - coint2.core.memory_optimization - INFO - 📊 No global rolling stats to clean up
2026-01-19 06:59:25,110 - INFO - 🧹 Memory-mapped data cleaned up
2026-01-19 06:59:25,111 - INFO - ⇠ run_walk_forward_analysis — done in 621.02s
⚙️  Загрузка данных за период: 2023-09-01 -> 2023-11-30
📂 Найдено 43 parquet файлов для обработки.
📊 Схема данных: Schema({'timestamp': Int64, 'open': Float64, 'high': Float64, 'low': Float64, 'close': Float64, 'volume': Float64, 'turnover': String, 'ts_ms': Int64, 'symbol': String})
✅ Загружено 2420293 записей с помощью Polars.
📊 Типы данных в pandas: timestamp       datetime64[us]
symbol                  object
close                  float64
timestamp_ms             int64
dtype: object
⚙️  Загрузка данных за период: 2023-10-01 -> 2023-12-30
📂 Найдено 43 parquet файлов для обработки.
📊 Схема данных: Schema({'timestamp': Int64, 'open': Float64, 'high': Float64, 'low': Float64, 'close': Float64, 'volume': Float64, 'turnover': String, 'ts_ms': Int64, 'symbol': String})
✅ Загружено 2499894 записей с помощью Polars.
📊 Типы данных в pandas: timestamp       datetime64[us]
symbol                  object
close                  float64
timestamp_ms             int64
dtype: object
⚙️  Загрузка данных за период: 2023-10-31 -> 2024-01-29
📂 Найдено 43 parquet файлов для обработки.
📊 Схема данных: Schema({'timestamp': Int64, 'open': Float64, 'high': Float64, 'low': Float64, 'close': Float64, 'volume': Float64, 'turnover': String, 'ts_ms': Int64, 'symbol': String})
✅ Загружено 2615053 записей с помощью Polars.
📊 Типы данных в pandas: timestamp       datetime64[us]
symbol                  object
close                  float64
timestamp_ms             int64
dtype: object
⚙️  Загрузка данных за период: 2023-11-30 -> 2024-02-28
📂 Найдено 43 parquet файлов для обработки.
📊 Схема данных: Schema({'timestamp': Int64, 'open': Float64, 'high': Float64, 'low': Float64, 'close': Float64, 'volume': Float64, 'turnover': String, 'ts_ms': Int64, 'symbol': String})
✅ Загружено 2755343 записей с помощью Polars.
📊 Типы данных в pandas: timestamp       datetime64[us]
symbol                  object
close                  float64
timestamp_ms             int64
dtype: object
📊 Отчет сохранен: artifacts/wfa/runs/20260119_stability_shortlist/stability_20260119_pv0p02_hurst0p48_hl0p05_30_corr0p7_ssd12000/CointegrationStrategy_performance_report.png
🎯 ============================================================
📊 ИТОГИ ТОРГОВОЙ СТРАТЕГИИ
🎯 ============================================================

💰 ФИНАНСОВЫЕ РЕЗУЛЬТАТЫ:
   • Общий P&L:                           17
   • Максимальная просадка:               -8
   • Средний дневной P&L:                  1

📈 МЕТРИКИ РИСКА:
   • Коэффициент Шарпа:               4.2141
   • Волатильность P&L:                 2.37
   • Процент прибыльных дней:         38.71%

🔄 ТОРГОВАЯ АКТИВНОСТЬ:
   • Всего торговых дней:                 31
   • Всего сделок:                        79
   • Торгуемых пар:                        4
   • Сделок на пару:                    19.8
   • Успешность сделок:               0.39%

💸 РАСХОДЫ И ЭКСТРЕМУМЫ:
   • Общие расходы:                        4
   • Максимальная прибыль:                 7
   • Максимальный убыток:                 -7
   • Лучшая пара (P&L):                    9
   • Худшая пара (P&L):                   -1

📊 ОЦЕНКА СТРАТЕГИИ:
   ✅ ОТЛИЧНАЯ стратегия! Высокий Шарп и положительный результат

🎯 ============================================================

Annualized Sharpe Ratio: 4.214121219365719
[run_wfa_fullcpu] end: 2026-01-19T06:59:26Z
