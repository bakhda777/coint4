# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞

## –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä —Å –±–∏—Ä–∂–∏, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Apache Parquet —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–º –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ –¥–∞—Ç–µ.

## üìÅ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

```
data/
‚îú‚îÄ‚îÄ –¢–û–†–ì–û–í–ê–Ø_–ü–ê–†–ê/                    # –ù–∞–ø—Ä–∏–º–µ—Ä: BTCUSDT, ETHUSDT, DOGEUSDT
‚îÇ   ‚îú‚îÄ‚îÄ year=YYYY/                    # –ì–æ–¥ (2022-2025)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ month=MM/                 # –ú–µ—Å—è—Ü (1-12)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ day=DD/               # –î–µ–Ω—å (1-31)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hash1.parquet     # –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–µ–Ω—å
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hash2.parquet     
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ day=DD+1/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ month=MM+1/
‚îÇ   ‚îî‚îÄ‚îÄ year=YYYY+1/
‚îú‚îÄ‚îÄ .symbols_cache.json               # –ö—ç—à —Å–ø–∏—Å–∫–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä
‚îú‚îÄ‚îÄ .gitkeep                         # –§–∞–π–ª –¥–ª—è git
‚îî‚îÄ‚îÄ ignore.txt                       # –§–∞–π–ª –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:
- **Hive-style –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: `year=YYYY/month=MM/day=DD/`
- **–û–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å = –æ–¥–Ω–∞ —Ç–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞**: –∫–∞–∂–¥–∞—è –ø–∞–ø–∫–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è - –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞—Ä–∞
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞ –¥–µ–Ω—å**: –¥–∞–Ω–Ω—ã–µ –∑–∞ –æ–¥–∏–Ω –¥–µ–Ω—å –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ parquet —Ñ–∞–π–ª–æ–≤

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä | 424 |
| –í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥ | 2022-2025 –≥–æ–¥—ã |
| –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö | ~3.2 GB |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ parquet —Ñ–∞–π–ª–æ–≤ | 555,052 |
| –í—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª | 15-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏ |

## üìà –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –≤ parquet —Ñ–∞–π–ª–∞—Ö

–ö–∞–∂–¥—ã–π parquet —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã:

| –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|------------|----------|---------|
| `timestamp` | int64 | –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö UTC | 1733011200000 |
| `symbol` | object (string) | –°–∏–º–≤–æ–ª —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã | "BTCUSDT" |
| `open` | float64 | –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∑–∞ 15-–º–∏–Ω—É—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ | 96484.0 |
| `high` | float64 | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ | 96687.8 |
| `low` | float64 | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ | 96412.5 |
| `close` | float64 | –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥ | 96633.1 |
| `volume` | float64 | –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥ | 362.012 |
| `ts_ms` | int64 | –î—É–±–ª–∏—Ä—É–µ—Ç timestamp (–∏–∑–±—ã—Ç–æ—á–Ω—ã–π) | 1733011200000 |

### –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ **–ë–µ–∑ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**: –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- ‚ö†Ô∏è **–î—É–±–ª–∏–∫–∞—Ç—ã timestamp**: –¥–∞–Ω–Ω—ã–µ –∑–∞ –¥–µ–Ω—å –º–æ–≥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- ‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç**: –≤—Å–µ —Ñ–∞–π–ª—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ö–µ–º—É

## ‚è∞ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–∞–Ω–Ω—ã—Ö:
- **–ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª**: 15 –º–∏–Ω—É—Ç = 900 —Å–µ–∫—É–Ω–¥
- **–ó–∞–ø–∏—Å–µ–π –∑–∞ –¥–µ–Ω—å**: 96 (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏) –¥–æ 480+ (—Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏)
- **–ù–∞—á–∞–ª–æ –¥–Ω—è**: 00:00:00 UTC
- **–ö–æ–Ω–µ—Ü –¥–Ω—è**: 23:45:00 UTC

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏:
```python
import pandas as pd

# –ò–∑ timestamp –≤ datetime
datetime_obj = pd.to_datetime(timestamp, unit='ms')

# –ò–∑ datetime –≤ timestamp  
timestamp = int(datetime_obj.timestamp() * 1000)
```

## üí± –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
- **Bitcoin –ø–∞—Ä—ã**: BTCUSDT, BTCUSDC, BTCEUR, BTCBRL, BTCBRZ
- **Ethereum –ø–∞—Ä—ã**: ETHUSDT, ETHUSDC, ETHEUR, ETHBTC
- **–ö—Ä—É–ø–Ω—ã–µ –∞–ª—å—Ç–∫–æ–∏–Ω—ã**: ADAUSDT, BNBUSDT, SOLUSDT, DOGEUSDT
- **DeFi —Ç–æ–∫–µ–Ω—ã**: UNIUSDT, LINKUSDT, AAVEUSDT, CRVUSDT
- **–ú–µ–º–∫–æ–∏–Ω—ã**: SHIBUSDT, FLOKIUSDT, BONKUSDT
- **–°—Ç–µ–π–±–ª–∫–æ–∏–Ω—ã**: DAIUSDT, USDCUSDT

### –í–∞–ª—é—Ç—ã –∫–æ—Ç–∏—Ä–æ–≤–∫–∏:
- **USDT** (Tether) - –æ—Å–Ω–æ–≤–Ω–∞—è
- **USDC** (USD Coin)
- **EUR** (–ï–≤—Ä–æ)
- **BTC** (Bitcoin)
- **BRL** (–ë—Ä–∞–∑–∏–ª—å—Å–∫–∏–π —Ä–µ–∞–ª)
- **TRY** (–¢—É—Ä–µ—Ü–∫–∞—è –ª–∏—Ä–∞)

## üîß –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

### –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ –¥–Ω—è:
```python
import pandas as pd

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–µ–Ω—å (–≤—Å–µ parquet —Ñ–∞–π–ª—ã)
df = pd.read_parquet('data/BTCUSDT/year=2024/month=12/day=1/')

# –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ timestamp
df = df.drop_duplicates(subset=['timestamp']).sort_values('timestamp')
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—Ç:
```python
import pandas as pd
from pathlib import Path

def load_symbol_data(symbol, start_date, end_date):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥"""
    dfs = []
    current = start_date
    
    while current <= end_date:
        path = f"data/{symbol}/year={current.year}/month={current.month}/day={current.day}/"
        if Path(path).exists():
            df_day = pd.read_parquet(path)
            dfs.append(df_day)
        current += pd.Timedelta(days=1)
    
    if dfs:
        df = pd.concat(dfs, ignore_index=True)
        return df.drop_duplicates(subset=['timestamp']).sort_values('timestamp')
    return pd.DataFrame()
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö BTCUSDT –∑–∞ –¥–µ–∫–∞–±—Ä—å 2024
start = pd.Timestamp('2024-12-01')
end = pd.Timestamp('2024-12-31')
btc_data = load_symbol_data('BTCUSDT', start, end)

print(f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(btc_data)} –∑–∞–ø–∏—Å–µ–π")
print(f"–ü–µ—Ä–∏–æ–¥: {pd.to_datetime(btc_data['timestamp'].min(), unit='ms')} - {pd.to_datetime(btc_data['timestamp'].max(), unit='ms')}")
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:
1. **–î—É–±–ª–∏–∫–∞—Ç—ã**: –í—Å–µ–≥–¥–∞ —É–¥–∞–ª—è–π—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ timestamp –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–Ω—è
2. **–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å**: –í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ UTC
3. **–†–∞–∑–º–µ—Ä**: –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ parquet –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `pandas.read_parquet()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `dask`
- –ö—ç—à–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```python
pandas>=1.5.0
pyarrow>=8.0.0  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å parquet
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.symbols_cache.json` –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–∞—Ä
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `pandas.read_parquet().info()` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ö–µ–º—ã —Ñ–∞–π–ª–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π 